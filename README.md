# üöÄ Flask Blog ‚Äî –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîß **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î**
- **Entrypoint —Å–∫—Ä–∏–ø—Ç** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- **–û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ PostgreSQL** –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏** —á–µ—Ä–µ–∑ Flask-Migrate

### üè• **Health Checks**
- **Docker health checks** –¥–ª—è web –∏ db —Å–µ—Ä–≤–∏—Å–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- **Graceful startup** —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### üê≥ **–£–ª—É—á—à–µ–Ω–Ω—ã–π Docker**
- **Multi-stage build** —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
git clone <your-repo>
cd blog-flask
chmod +x run_tests_docker.sh restart_final.sh
```

### 2. –ó–∞–ø—É—Å–∫ –≤ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
./restart_final.sh

# –ò–ª–∏ –ø–æ—à–∞–≥–æ–≤–æ:
docker compose up -d --build
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
docker compose ps
docker logs blog-flask-web-1
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –¢–µ—Å—Ç—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ (–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î)
./run_tests_docker.sh

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
docker exec blog-flask-web-1 python -m pytest -v
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### **–°–µ—Ä–≤–∏—Å—ã**
- **web**: Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –ë–î
- **db**: PostgreSQL 15 —Å health checks –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π

### **Entrypoint —Å–∫—Ä–∏–ø—Ç**
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:
1. –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ PostgreSQL
2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ë–î
3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
4. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

### **Health Checks**
- **Web**: HTTP GET / (curl)
- **DB**: pg_isready
- **–ò–Ω—Ç–µ—Ä–≤–∞–ª—ã**: 30s –¥–ª—è web, 10s –¥–ª—è db

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **–õ–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**
```bash
# Web —Å–µ—Ä–≤–∏—Å
docker logs blog-flask-web-1 -f

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
docker logs blog-flask-db-1 -f

# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker compose logs -f
```

### **–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤**
```bash
docker compose ps
docker compose exec web curl -f http://localhost:5000/
docker compose exec db pg_isready -U postgres
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ**
```bash
# –¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç SQLite –≤ –ø–∞–º—è—Ç–∏ –∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é –ë–î
./run_tests_docker.sh
```

### **–õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã**
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
python -m pytest -v
```

## üöÄ –ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ–π

### **CI/CD Pipeline (GitHub Actions)**
- **Test Stage**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–º push
- **Build & Push Stage**: –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –≤ Google Artifact Registry
- **Deploy Stage**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –≤ GKE –∫–ª–∞—Å—Ç–µ—Ä

### **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Terraform)**
- **GKE –∫–ª–∞—Å—Ç–µ—Ä** —Å –∞–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥–æ–º
- **Cloud SQL** (PostgreSQL) –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- **Load Balancer** –∏ **Ingress** –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- **Workload Identity Federation** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### **Kubernetes –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã**
- **Deployment** —Å health checks (liveness/readiness probes)
- **Service** –∏ **Ingress** –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
- **ConfigMap** –∏ **Secrets** –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **HorizontalPodAutoscaler** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### **–ü—Ä–æ–±–ª–µ–º—ã —Å Docker**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞
sudo usermod -aG docker $USER && newgrp docker

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
./restart_final.sh
```

### **–ü—Ä–æ–±–ª–µ–º—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose ps

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ë–î
docker exec blog-flask-db-1 psql -U postgres -d postgres -c "\dt"

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ë–î –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
docker exec blog-flask-web-1 python init_db.py
```

### **–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker logs blog-flask-web-1 -f

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
curl -I http://localhost:5000
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
blog-flask/
‚îú‚îÄ‚îÄ app.py                 # –û—Å–Ω–æ–≤–Ω–æ–µ Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ requirements.txt       # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ Dockerfile            # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml    # –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
‚îú‚îÄ‚îÄ docker-entrypoint.sh  # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
‚îú‚îÄ‚îÄ init_db.py            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ run_tests_docker.sh   # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
‚îú‚îÄ‚îÄ restart_final.sh      # –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
‚îú‚îÄ‚îÄ k8s/                  # Kubernetes –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ blog-infra/           # Terraform –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ .github/workflows/    # CI/CD pipeline
```

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
./restart_final.sh

# –¢–µ—Å—Ç—ã
./run_tests_docker.sh

# –°—Ç–∞—Ç—É—Å
docker compose ps

# –õ–æ–≥–∏
docker logs blog-flask-web-1 -f

# –î–æ—Å—Ç—É–ø –∫ –ë–î
docker exec -it blog-flask-db-1 psql -U postgres -d postgres
```
